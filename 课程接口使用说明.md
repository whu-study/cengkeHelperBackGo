# 课程接口使用说明

## 新增接口：获取结构化课程数据

### 接口地址
```
GET /api/v1/courses/structured
```

### 接口说明
这个接口返回按照**四级结构**（学部 → 教学楼 → 楼层 → 课程）组织的课程数据，完全匹配前端开发提供的API设计文档。

### 响应格式
```json
{
  "code": 0,
  "msg": "课程数据获取成功",
  "data": [
    {
      "divisionId": "division_1",
      "divisionName": "文理学部",
      "description": "文理学部教学区域",
      "icon": "/assets/icons/division_1.svg",
      "totalBuildings": 3,
      "totalFloors": 12,
      "totalCourses": 45,
      "buildings": [
        {
          "buildingId": "division_1_教学楼a",
          "buildingName": "教学楼A",
          "buildingCode": "A",
          "address": "武汉大学文理学部",
          "description": "",
          "totalFloors": 4,
          "totalRooms": 20,
          "totalCourses": 15,
          "floors": [
            {
              "floorId": "division_1_教学楼a_F1",
              "floorName": "A 1层",
              "floorNumber": 1,
              "description": "",
              "rooms": [
                {
                  "roomId": "division_1_教学楼a_F1_A101",
                  "roomNumber": "A101",
                  "roomName": "教室 A101",
                  "capacity": 0,
                  "roomType": "",
                  "facilities": ["投影仪", "空调", "网络"]
                }
              ],
              "courses": [
                {
                  "id": 1001,
                  "courseName": "高等数学A(1)",
                  "courseCode": "2024-2025-1-MATH101",
                  "teacherName": "张教授",
                  "teacherTitle": "教授",
                  "faculty": "数学与统计学院",
                  "credits": 4.0,
                  "courseType": "必修课",
                  "room": "A101",
                  "timeSlots": [
                    {
                      "dayOfWeek": 1,
                      "startPeriod": 1,
                      "endPeriod": 2,
                      "weeks": "1-16周"
                    }
                  ],
                  "capacity": 0,
                  "enrolled": 0,
                  "description": "微积分基础理论与应用",
                  "averageRating": 4.2,
                  "reviewCount": 23
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
```

## 数据结构说明

### 1. 学部 (Division)
- `divisionId`: 学部唯一标识（根据Area字段生成：1=文理学部, 2=信息学部, 3=工学部, 4=医学部）
- `divisionName`: 学部名称
- `totalBuildings`: 该学部下教学楼总数
- `totalFloors`: 该学部下楼层总数
- `totalCourses`: 该学部下课程总数

### 2. 教学楼 (Building)
- `buildingId`: 教学楼唯一标识
- `buildingName`: 教学楼名称（来自TimeInfo表的Building字段）
- `buildingCode`: 教学楼代码（自动提取，如"A"、"B"等）
- `totalFloors`: 该教学楼的楼层数
- `totalRooms`: 该教学楼的教室数
- `totalCourses`: 该教学楼的课程数

### 3. 楼层 (Floor)
- `floorId`: 楼层唯一标识
- `floorName`: 楼层名称
- `floorNumber`: 楼层号（从教室编号自动提取）
- `rooms`: 该楼层的教室列表
- `courses`: 该楼层的课程列表

### 4. 教室 (Room)
- `roomId`: 教室唯一标识
- `roomNumber`: 教室编号（来自TimeInfo表的Classroom字段）
- `facilities`: 设施列表（目前默认返回["投影仪", "空调", "网络"]）

### 5. 课程 (Course)
- `timeSlots`: 上课时间段数组
  - `dayOfWeek`: 星期几 (0=周日, 1=周一, ..., 6=周六)
  - `startPeriod`: 开始节次
  - `endPeriod`: 结束节次
  - `weeks`: 周次范围（如"1-16周"）

## 与现有接口的对比

### 现有接口
```
GET /api/v1/courses
```
返回简单的二维数组结构（学部 → 教学楼），适用于简单的课程列表展示。

### 新接口
```
GET /api/v1/courses/structured
```
返回完整的四级结构（学部 → 教学楼 → 楼层 → 课程），提供更详细的层次信息，包括：
- ✅ 楼层信息（新增）
- ✅ 教室详细信息（新增）
- ✅ 时间段详细信息（新增）
- ✅ 统计信息（课程数、教室数、楼层数等）
- ✅ 完整的课程字段（学分、课程代码等）

## 使用建议

1. **前端展示**：使用新接口可以实现更丰富的四级导航展示
2. **性能考虑**：如果数据量大，建议在服务端增加Redis缓存
3. **筛选功能**：后续可以基于这个接口添加筛选参数（学部ID、教学楼ID、楼层等）

## 数据来源

新接口基于现有的数据表：
- `course_infos`: 课程基本信息
- `time_infos`: 课程时间和地点信息（包含Area、Building、Classroom字段）

通过智能解析和聚合，自动生成楼层信息和层次结构。

